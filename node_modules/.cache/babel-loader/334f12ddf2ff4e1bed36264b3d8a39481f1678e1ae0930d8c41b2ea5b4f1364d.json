{"ast":null,"code":"import axios from 'axios';\nexport const extractVideoId = url => {\n  const regExp = /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&v=)([^#&?]*).*/;\n  const match = url.match(regExp);\n  return match && match[2].length === 11 ? match[2] : null;\n};\nexport const getVideoTranscript = async videoId => {\n  try {\n    var _videoResponse$data$i, _captionsResponse$dat;\n    const API_KEY = process.env.REACT_APP_YOUTUBE_API_KEY;\n    if (!API_KEY) {\n      throw new Error('YouTube API key is not configured. Please add REACT_APP_YOUTUBE_API_KEY to your environment variables.');\n    }\n\n    // First, get video details to check if captions are available\n    const videoResponse = await axios.get(`https://www.googleapis.com/youtube/v3/videos?part=snippet&id=${videoId}&key=${API_KEY}`);\n    if (!((_videoResponse$data$i = videoResponse.data.items) !== null && _videoResponse$data$i !== void 0 && _videoResponse$data$i.length)) {\n      throw new Error('Video not found');\n    }\n\n    // Get captions track\n    const captionsResponse = await axios.get(`https://www.googleapis.com/youtube/v3/captions?part=snippet&videoId=${videoId}&key=${API_KEY}`);\n    if (!((_captionsResponse$dat = captionsResponse.data.items) !== null && _captionsResponse$dat !== void 0 && _captionsResponse$dat.length)) {\n      throw new Error('No captions available for this video');\n    }\n\n    // Get the actual transcript\n    const transcriptResponse = await axios.get(`https://www.googleapis.com/youtube/v3/captions/${captionsResponse.data.items[0].id}?key=${API_KEY}`);\n    return transcriptResponse.data.transcript;\n  } catch (error) {\n    var _error$response, _error$response2;\n    console.error('Error fetching transcript:', error);\n    if ((error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 403) {\n      throw new Error('API key is invalid or quota exceeded. Please check your YouTube API configuration.');\n    }\n    if ((error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 404) {\n      throw new Error('Video not found or captions are not available.');\n    }\n    throw new Error('Failed to fetch video transcript. Please make sure the video has captions available.');\n  }\n};","map":{"version":3,"names":["axios","extractVideoId","url","regExp","match","length","getVideoTranscript","videoId","_videoResponse$data$i","_captionsResponse$dat","API_KEY","process","env","REACT_APP_YOUTUBE_API_KEY","Error","videoResponse","get","data","items","captionsResponse","transcriptResponse","id","transcript","error","_error$response","_error$response2","console","response","status"],"sources":["D:/rvce/src/services/youtubeService.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\ninterface TranscriptResponse {\r\n  transcript: string;\r\n}\r\n\r\ninterface VideoResponse {\r\n  items: Array<{\r\n    id: string;\r\n    snippet: {\r\n      title: string;\r\n      description: string;\r\n    };\r\n  }>;\r\n}\r\n\r\ninterface CaptionsResponse {\r\n  items: Array<{\r\n    id: string;\r\n    snippet: {\r\n      language: string;\r\n    };\r\n  }>;\r\n}\r\n\r\nexport const extractVideoId = (url: string): string | null => {\r\n  const regExp = /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&v=)([^#&?]*).*/;\r\n  const match = url.match(regExp);\r\n  return (match && match[2].length === 11) ? match[2] : null;\r\n};\r\n\r\nexport const getVideoTranscript = async (videoId: string): Promise<string> => {\r\n  try {\r\n    const API_KEY = process.env.REACT_APP_YOUTUBE_API_KEY;\r\n    \r\n    if (!API_KEY) {\r\n      throw new Error('YouTube API key is not configured. Please add REACT_APP_YOUTUBE_API_KEY to your environment variables.');\r\n    }\r\n\r\n    // First, get video details to check if captions are available\r\n    const videoResponse = await axios.get<VideoResponse>(\r\n      `https://www.googleapis.com/youtube/v3/videos?part=snippet&id=${videoId}&key=${API_KEY}`\r\n    );\r\n\r\n    if (!videoResponse.data.items?.length) {\r\n      throw new Error('Video not found');\r\n    }\r\n\r\n    // Get captions track\r\n    const captionsResponse = await axios.get<CaptionsResponse>(\r\n      `https://www.googleapis.com/youtube/v3/captions?part=snippet&videoId=${videoId}&key=${API_KEY}`\r\n    );\r\n\r\n    if (!captionsResponse.data.items?.length) {\r\n      throw new Error('No captions available for this video');\r\n    }\r\n\r\n    // Get the actual transcript\r\n    const transcriptResponse = await axios.get<TranscriptResponse>(\r\n      `https://www.googleapis.com/youtube/v3/captions/${captionsResponse.data.items[0].id}?key=${API_KEY}`\r\n    );\r\n\r\n    return transcriptResponse.data.transcript;\r\n  } catch (error: any) {\r\n    console.error('Error fetching transcript:', error);\r\n    if (error?.response?.status === 403) {\r\n      throw new Error('API key is invalid or quota exceeded. Please check your YouTube API configuration.');\r\n    }\r\n    if (error?.response?.status === 404) {\r\n      throw new Error('Video not found or captions are not available.');\r\n    }\r\n    throw new Error('Failed to fetch video transcript. Please make sure the video has captions available.');\r\n  }\r\n}; "],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAyBzB,OAAO,MAAMC,cAAc,GAAIC,GAAW,IAAoB;EAC5D,MAAMC,MAAM,GAAG,8DAA8D;EAC7E,MAAMC,KAAK,GAAGF,GAAG,CAACE,KAAK,CAACD,MAAM,CAAC;EAC/B,OAAQC,KAAK,IAAIA,KAAK,CAAC,CAAC,CAAC,CAACC,MAAM,KAAK,EAAE,GAAID,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI;AAC5D,CAAC;AAED,OAAO,MAAME,kBAAkB,GAAG,MAAOC,OAAe,IAAsB;EAC5E,IAAI;IAAA,IAAAC,qBAAA,EAAAC,qBAAA;IACF,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,yBAAyB;IAErD,IAAI,CAACH,OAAO,EAAE;MACZ,MAAM,IAAII,KAAK,CAAC,wGAAwG,CAAC;IAC3H;;IAEA;IACA,MAAMC,aAAa,GAAG,MAAMf,KAAK,CAACgB,GAAG,CACnC,gEAAgET,OAAO,QAAQG,OAAO,EACxF,CAAC;IAED,IAAI,GAAAF,qBAAA,GAACO,aAAa,CAACE,IAAI,CAACC,KAAK,cAAAV,qBAAA,eAAxBA,qBAAA,CAA0BH,MAAM,GAAE;MACrC,MAAM,IAAIS,KAAK,CAAC,iBAAiB,CAAC;IACpC;;IAEA;IACA,MAAMK,gBAAgB,GAAG,MAAMnB,KAAK,CAACgB,GAAG,CACtC,uEAAuET,OAAO,QAAQG,OAAO,EAC/F,CAAC;IAED,IAAI,GAAAD,qBAAA,GAACU,gBAAgB,CAACF,IAAI,CAACC,KAAK,cAAAT,qBAAA,eAA3BA,qBAAA,CAA6BJ,MAAM,GAAE;MACxC,MAAM,IAAIS,KAAK,CAAC,sCAAsC,CAAC;IACzD;;IAEA;IACA,MAAMM,kBAAkB,GAAG,MAAMpB,KAAK,CAACgB,GAAG,CACxC,kDAAkDG,gBAAgB,CAACF,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC,CAACG,EAAE,QAAQX,OAAO,EACpG,CAAC;IAED,OAAOU,kBAAkB,CAACH,IAAI,CAACK,UAAU;EAC3C,CAAC,CAAC,OAAOC,KAAU,EAAE;IAAA,IAAAC,eAAA,EAAAC,gBAAA;IACnBC,OAAO,CAACH,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;IAClD,IAAI,CAAAA,KAAK,aAALA,KAAK,wBAAAC,eAAA,GAALD,KAAK,CAAEI,QAAQ,cAAAH,eAAA,uBAAfA,eAAA,CAAiBI,MAAM,MAAK,GAAG,EAAE;MACnC,MAAM,IAAId,KAAK,CAAC,oFAAoF,CAAC;IACvG;IACA,IAAI,CAAAS,KAAK,aAALA,KAAK,wBAAAE,gBAAA,GAALF,KAAK,CAAEI,QAAQ,cAAAF,gBAAA,uBAAfA,gBAAA,CAAiBG,MAAM,MAAK,GAAG,EAAE;MACnC,MAAM,IAAId,KAAK,CAAC,gDAAgD,CAAC;IACnE;IACA,MAAM,IAAIA,KAAK,CAAC,sFAAsF,CAAC;EACzG;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}